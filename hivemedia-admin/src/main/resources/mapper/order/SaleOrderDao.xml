<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.hivemedia.modules.order.dao.SaleOrderDao">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="cn.hivemedia.modules.order.entity.SaleOrderEntity" id="saleOrderMap">
        <result property="id" column="id"/>
        <result property="saleUserId" column="sale_user_id"/>
        <result property="buyUserId" column="buy_user_id"/>
        <result property="orderNo" column="order_no"/>
        <result property="orderStatus" column="order_status"/>
        <result property="cancelReason" column="cancel_reason"/>
        <result property="goodsCount" column="goods_count"/>
        <result property="amountTotal" column="amount_total"/>
        <result property="orderAmountTotal" column="order_amount_total"/>
        <result property="logisticsFee" column="logistics_fee"/>
        <result property="makeOutInvoice" column="make_out_invoice"/>
        <result property="invoiceNo" column="invoice_no"/>
        <result property="address" column="address"/>
        <result property="logisticsId" column="logistics_id"/>
        <result property="payChannel" column="pay_channel"/>
        <result property="createTime" column="create_time"/>
        <result property="payTime" column="pay_time"/>
        <result property="remarks" column="remarks"/>
        <result property="updateTime" column="update_time"/>
        <result property="curState" column="cur_state"/>
        <result property="couponId" column="coupon_id"/>
        <result property="saleType" column="sale_type"/>
        <result property="deposit" column="deposit"/>
        <result property="bankFee" column="bank_fee"/>
        <result property="goodsCheckFee" column="goods_check_fee"/>
        <result property="packFee" column="pack_fee"/>
        <result property="proceduresFee" column="procedures_fee"/>
        <result property="expressFee" column="express_fee"/>
    </resultMap>
    <select id="selectOutOfTime" resultType="cn.hivemedia.modules.order.entity.SaleOrderEntity">
        select * from tb_sale_order where create_time &lt; now() - INTERVAL  #{time} MINUTE
        and order_status = #{orderStatus} limit #{index},#{size}
    </select>

    <select id="selectPriceOrdersBiMinPrice" resultMap="saleOrderMap">
        select *
        from tb_sale_order
        where amount_total > #{amountTotal} and order_status = 0
        and goods_id = #{goodsId} and size_id = #{sizeId}
        and is_sale = 0 and cur_state = 1
    </select>

    <select id="selectByPurchasePrice" resultMap="saleOrderMap">
        select *
        from tb_sale_order
        where ( amount_total between (#{amountTotal} - 100) and (#{amountTotal} + 100) ) and order_status = 0
        and goods_id = #{goodsId} and size_id = #{sizeId}
        and is_sale = 0 and cur_state = 1
    </select>

    <select id="selectSaleOrderList" resultMap="saleOrderMap">
        select *
        from tb_sale_order
        where order_status = 0
        and goods_id = #{goodsId} and size_id = #{sizeId}
        and is_sale = 0 and cur_state = 1
    </select>




</mapper>